# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π –¥–ª—è Production

## üìß SendGrid Email (–¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º)

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ SendGrid
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://sendgrid.com/
2. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω: 100 –ø–∏—Å–µ–º/–¥–µ–Ω—å

### –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞
1. –í–æ–π–¥–∏—Ç–µ –≤ SendGrid Dashboard
2. Settings ‚Üí API Keys
3. Create API Key
4. –í—ã–±–µ—Ä–∏—Ç–µ "Full Access"
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!)

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ
–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ:

```env
EMAIL_MODE="production"
SENDGRID_API_KEY="SG.–≤–∞—à_—Ä–µ–∞–ª—å–Ω—ã–π_–∫–ª—é—á_–∑–¥–µ—Å—å"
EMAIL_FROM="noreply@lulu-alpaca.ru"
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
curl -X POST http://localhost:3000/api/email/test \
  -H "Content-Type: application/json" \
  -d '{"email": "your@email.com"}'
```

---

## üîó AmoCRM (–¥–ª—è CRM)

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
1. –í–æ–π–¥–∏—Ç–µ –≤ AmoCRM
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Üí –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
3. –¢–∏–ø: "–°–µ—Ä–≤–µ—Ä–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"

### –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
1. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—É—á–∏—Ç–µ:
   - Client ID
   - Client Secret
   - Redirect URI

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è:
   - Access Token
   - Refresh Token

### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ ID –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø–æ–ª–µ–π
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–µ–π
2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Å–¥–µ–ª–æ–∫:
   - "–í–∑—Ä–æ—Å–ª—ã–µ –±–∏–ª–µ—Ç—ã" (—á–∏—Å–ª–æ)
   - "–î–µ—Ç—Å–∫–∏–µ –±–∏–ª–µ—Ç—ã" (—á–∏—Å–ª–æ)
   - "–î–µ—Ç—Å–∫–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –±–∏–ª–µ—Ç—ã" (—á–∏—Å–ª–æ)
   - "–î–∞—Ç–∞ —ç–∫—Å–∫—É—Ä—Å–∏–∏" (–¥–∞—Ç–∞)
   - "–°—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É" (—Ç–µ–∫—Å—Ç)

3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è

### –®–∞–≥ 4: –ü–æ–ª—É—á–µ–Ω–∏–µ ID –≤–æ—Ä–æ–Ω–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å–æ–≤
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–æ—Ä–æ–Ω–∫—É –ø—Ä–æ–¥–∞–∂
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –≤–æ—Ä–æ–Ω–∫–∏ (pipeline_id)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Å—Ç–∞—Ç—É—Å–æ–≤:
   - "–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ" (status_id –¥–ª—è –Ω–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫)
   - "–û–ø–ª–∞—á–µ–Ω–æ" (status_id –¥–ª—è –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö)

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ
–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ:

```env
AMOCRM_MODE="production"
AMOCRM_SUBDOMAIN="your-company"
AMOCRM_ACCESS_TOKEN="eyJ0..."
AMOCRM_REFRESH_TOKEN="def50..."
AMOCRM_CLIENT_ID="123abc..."
AMOCRM_CLIENT_SECRET="abc123..."

# –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è
AMOCRM_FIELD_ADULT_TICKETS="123456"
AMOCRM_FIELD_CHILD_TICKETS="123457"
AMOCRM_FIELD_INFANT_TICKETS="123458"
AMOCRM_FIELD_EXCURSION_DATE="123459"
AMOCRM_FIELD_PAYMENT_LINK="123460"

# –í–æ—Ä–æ–Ω–∫–∞ –∏ —Å—Ç–∞—Ç—É—Å—ã
AMOCRM_PIPELINE_ID="12345"
AMOCRM_STATUS_BOOKED="142"
AMOCRM_STATUS_PAID="143"
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
curl http://localhost:3000/api/amocrm/status
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –î–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞

–ï—Å–ª–∏ —É –≤–∞—Å –ù–ï–¢ —Ä–µ–∞–ª—å–Ω—ã—Ö API –∫–ª—é—á–µ–π, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ DEMO —Ä–µ–∂–∏–º–µ:
- Email –±—É–¥—É—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è)
- AmoCRM –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ñ–µ–π–∫–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ (–Ω–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–π CRM)

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### Email:
```bash
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–∏—Å—å–º–æ
curl -X POST http://localhost:3000/api/email/test \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com"}'

# –î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Ä–µ–∞–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ –Ω–∞ –ø–æ—á—Ç—É
```

### AmoCRM:
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤ AmoCRM –ø–æ—è–≤–∏–ª–∞—Å—å —Å–¥–µ–ª–∫–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç
```

---

## üìù –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ DEMO

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ DEMO —Ä–µ–∂–∏–º:

```env
EMAIL_MODE="demo"
AMOCRM_MODE="demo"
```

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–º–∏ - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –≤ DEMO.
